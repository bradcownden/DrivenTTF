(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43657,       1256]
NotebookOptionsPosition[     42459,       1213]
NotebookOutlinePosition[     42816,       1229]
CellTagsIndexPosition[     42773,       1226]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Examining integrals that contribute to secular terms from non-normalizable + \
normalizable modes with massive scalars. \
\>", "Section",
 CellChangeTimes->{{3.7629062006142387`*^9, 3.762906202879053*^9}, {
  3.762906258734685*^9, 3.762906341592255*^9}, {3.762967655302238*^9, 
  3.762967692187183*^9}, {3.762967814805538*^9, 3.76296783044731*^9}, {
  3.762975123828157*^9, 3.76297513133952*^9}, {3.763498583027974*^9, 
  3.763498654029675*^9}, {3.763588143022334*^9, 3.763588148798937*^9}, {
  3.7641701522503242`*^9, 3.764170154427072*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.763074721190872*^9, 3.763074726412595*^9}, {
  3.763074758070485*^9, 3.76307477359044*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Inputs", ":", " ", 
     RowBox[{"number", " ", "of", " ", "spatial", " ", "dimensions", " ", 
      RowBox[{"(", "d", ")"}], " ", "of", " ", "the", " ", "bulk", " ", 
      "theory"}]}], ";", "  ", 
    RowBox[{"mass", " ", 
     RowBox[{"(", "m", ")"}], " ", "of", " ", "the", " ", "scalar", " ", 
     "field"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d", ":=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", " ", ":=", " ", "0"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.763498687025902*^9, 3.763498712250783*^9}, {
  3.763498985635792*^9, 3.763498991611847*^9}, {3.763499129886156*^9, 
  3.7634991689590807`*^9}, {3.7634992276852903`*^9, 3.7634992277797422`*^9}, {
  3.763499748536438*^9, 3.763499773999934*^9}, {3.763507651719101*^9, 
  3.7635076521746798`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Helpful", " ", "secondary", " ", "functions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Dpl", " ", "=", " ", 
     RowBox[{
      RowBox[{"d", "/", "2"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"d", "^", "2"}], " ", "+", " ", 
         RowBox[{"4", 
          RowBox[{"m", "^", "2"}]}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dmin", " ", "=", " ", 
     RowBox[{
      RowBox[{"d", "/", "2"}], " ", "-", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"d", "^", "2"}], " ", "+", " ", 
         RowBox[{"4", 
          RowBox[{"m", "^", "2"}]}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"omega", "[", "i_", "]"}], ":=", 
     RowBox[{"Dpl", " ", "+", " ", 
      RowBox[{"2", "i"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mu", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Tan", "[", "x", "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nu", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}], "/", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], ",", "x"}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.762904629077486*^9, 3.762904633998115*^9}, 
   3.762975133476315*^9, {3.762975165437059*^9, 3.7629752663415737`*^9}, {
   3.7630744354069233`*^9, 3.763074435459634*^9}, {3.763075125911824*^9, 
   3.763075126214349*^9}, {3.7630751804440947`*^9, 3.7630751805306053`*^9}, {
   3.763157220689012*^9, 3.7631572213103952`*^9}, {3.7631573055706673`*^9, 
   3.763157332194145*^9}, {3.763161497774618*^9, 3.763161501260707*^9}, {
   3.763161659811837*^9, 3.763161659896862*^9}, {3.763161847928557*^9, 
   3.763161861031417*^9}, {3.763329572967142*^9, 3.7633295733761272`*^9}, {
   3.7634089940877*^9, 3.763409026493307*^9}, {3.7634139073691072`*^9, 
   3.763413907580092*^9}, {3.7634152222960243`*^9, 3.763415222494063*^9}, {
   3.763416911301551*^9, 3.763416911882235*^9}, {3.7634175633272448`*^9, 
   3.763417583569435*^9}, {3.763498549591984*^9, 3.763498561391902*^9}, 
   3.763498677017758*^9, {3.763498722395125*^9, 3.763498743235928*^9}, {
   3.764174348105587*^9, 3.764174355574226*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Normalizable", " ", "mode", " ", "basis", " ", "functions"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"k", "[", "i_", "]"}], ":=", 
     RowBox[{"2", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "+", 
          RowBox[{"Dpl", "/", "2"}]}], ")"}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"i", "+", "1"}], "]"}], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"i", "+", "Dpl"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Gamma", "[", 
            RowBox[{"i", "+", 
             RowBox[{"d", "/", "2"}]}], "]"}], 
           RowBox[{"Gamma", "[", 
            RowBox[{"i", "+", "Dpl", "-", 
             RowBox[{"d", "/", "2"}], "+", "1"}], "]"}]}], ")"}]}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"i_", ",", " ", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"k", "[", "i", "]"}], " ", 
      RowBox[{"JacobiP", "[", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"d", "/", "2"}], " ", "-", " ", "1"}], ",", 
        RowBox[{"Dpl", "-", 
         RowBox[{"d", "/", "2"}]}], ",", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "x"}], "]"}]}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cos", "[", "x", "]"}], ")"}], "^", "Dpl"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ep", "[", 
      RowBox[{"i_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"i", ",", "x"}], "]"}], ",", "x"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.762967865719746*^9, 3.762967871255427*^9}, {
  3.762969521826351*^9, 3.762969542679894*^9}, {3.762975320797474*^9, 
  3.762975376145011*^9}, {3.76341446148372*^9, 3.763414566876734*^9}, {
  3.763414777581973*^9, 3.763414799850561*^9}, {3.76349839408307*^9, 
  3.763498492627866*^9}, {3.76349894885436*^9, 3.7634989489417477`*^9}, {
  3.7634990663461647`*^9, 3.763499078366103*^9}, {3.763499397625011*^9, 
  3.763499399912448*^9}, {3.7634996111706867`*^9, 3.763499623562582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Non", "-", 
    RowBox[{"normalizable", " ", "mode", " ", "basis", " ", "function", " ", 
     RowBox[{"(", 
      RowBox[{"Nastase", " ", "12.28"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"nn", "[", 
      RowBox[{"w_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cos", "[", "x", "]"}], ")"}], "^", "Dpl"}], " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Dpl", " ", "+", " ", "w"}], ")"}], "/", "2"}], ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Dpl", "-", "w"}], ")"}], "/", "2"}], ",", " ", 
        RowBox[{"d", "/", "2"}], ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sin", "[", "x", "]"}], ")"}], "^", "2"}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nnp", "[", 
      RowBox[{"w_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"nn", "[", 
        RowBox[{"w", ",", "x"}], "]"}], ",", "x"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7635881616888437`*^9, 3.763588311193657*^9}, 
   3.764177191308857*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Integrals", " ", "that", " ", "appear", " ", "in", " ", "the", " ", 
     "expression", " ", "for", " ", "the", " ", "third"}], "-", 
    RowBox[{"order", " ", "source", " ", "term"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"V", "[", 
      RowBox[{"i_", ",", " ", "j_", ",", " ", "k_", ",", " ", "l_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"j", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"k", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"l", ",", "x"}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sec", "[", "x", "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"j", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"k", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"l", ",", "x"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Y", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"j", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"k", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"l", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"nu", "[", "x", "]"}], ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"j", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"k", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"l", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyFtIk2EAh/GPYjSnzciEAsMma4NBd2suFdGgmKJRa+3Q0lgglrWNNROb
mJFNJLxY5mFDUBhGAxWVFjMEFQ/bZLC6iFxlFlvUp2womrC+SHv/78XDDx7R
Lau67gDDMBISlIVcuQWCZLlMl18Bp8b9DjGxZPlQC4y+HtqE131L27Cl/kHG
aaL38Cw13sZmQ7u++SgUyrvWq4nivRGqIeOy/BKx/0cbtb0vpIQvWX4xVI66
z6uJGyvsBfhwwqSGujWbBp4ost6FHzVvqK8aWp1QLZd0wn/jyj44nIhQtyyB
Abj3rMoHs04K/DC97wzAjtYv09B1fHcGCpr13+Bj6fcN+FlVwcG5xhrmKjGc
yi+Ghj8c9VP6qwXOGH9ZoUPinYedhd2L0GSOh2Ewl41CPk/6ATIucYzaFF6n
P7CagokAuw1jvLHf0MK7w0Eur/EvXFDdOKghRtpvZkLm3JljsHRnXgQruXdS
ONjRr4AK46YKOsz2Sih82nMNlr0f08IjOdr7sEt0xQ4vbhW54KPas8/hvUlt
LzSKZ6n7t0ve9mYmy6sSsiAUcLYoLP3ppK56hINuotexS13beXLKQ5x6ERHB
/5d5EoQ=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Helpful", " ", "combinations", " ", "of", " ", "X", " ", "and", " ", 
    "Y"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Zpl", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"omega", "[", "i", "]"}], 
       RowBox[{"omega", "[", "j", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"k", ",", "l", ",", "i", ",", "j"}], "]"}], "-", 
         RowBox[{"X", "[", 
          RowBox[{"l", ",", "k", ",", "i", ",", "j"}], "]"}]}], ")"}]}], " ", 
      "+", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"i", ",", "j", ",", "l", ",", "k"}], "]"}], "-", 
        RowBox[{"Y", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Zmin", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"omega", "[", "i", "]"}], 
       RowBox[{"omega", "[", "j", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"k", ",", "l", ",", "i", ",", "j"}], "]"}], "-", 
         RowBox[{"X", "[", 
          RowBox[{"l", ",", "k", ",", "i", ",", "j"}], "]"}]}], ")"}]}], " ", 
      "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"i", ",", "j", ",", "l", ",", "k"}], "]"}], "-", 
        RowBox[{"Y", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.763499437301585*^9, 3.763499465093074*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Integrals", " ", "evaluated", " ", "for", " ", "combinations", " ", "of",
      " ", "normalizable", " ", "and", " ", "non"}], "-", 
    RowBox[{"normalizable", " ", "modes"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"X1", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"X2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Y1", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Y2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"V1", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sec", "[", "x", "]"}], ")"}], "^", "2"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"V2", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sec", "[", "x", "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H1", "[", 
      RowBox[{"i_", ",", "w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"nu", "[", "x", "]"}], ",", "x"}], "]"}], " ", 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H2", "[", 
      RowBox[{"w_", ",", "i_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"nu", "[", "x", "]"}], ",", "x"}], "]"}], " ", 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], " ", 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"mu", "[", "y", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"e", "[", 
           RowBox[{"i", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"mu", "[", "y", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nn", "[", 
           RowBox[{"w", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"B1", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"mu", "[", "y", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"e", "[", 
           RowBox[{"i", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"B2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nn", "[", 
           RowBox[{"w", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"M2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"nu", "[", "x", "]"}], ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"mu", "[", "y", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nn", "[", 
           RowBox[{"w", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sec", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"mu", "[", "y", "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nn", "[", 
           RowBox[{"w", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.764170361938056*^9, 3.764170904376463*^9}, 
   3.7641726456621847`*^9, {3.764172761461997*^9, 3.7641731438881893`*^9}, {
   3.764174448645485*^9, 3.764174468620513*^9}, {3.764175006726725*^9, 
   3.7641750912574587`*^9}, {3.764175645291501*^9, 3.7641757298436213`*^9}, {
   3.7641758085332127`*^9, 3.764175874694023*^9}, {3.764176000689888*^9, 
   3.764176001224359*^9}, {3.764176128971127*^9, 3.764176177082803*^9}, {
   3.76417720857195*^9, 3.764177214351563*^9}, {3.764177247239451*^9, 
   3.7641772905064373`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Combinations", " ", "of", " ", "integrals", " ", "evaluated", " ", "for",
      " ", "combinations", " ", "of", " ", "normalizable", " ", "and", " ", 
     "non"}], "-", 
    RowBox[{"normalizable", " ", "modes"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Zbarmin", "[", 
      RowBox[{"i_", ",", "w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"omega", "[", "i", "]"}], " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X1", "[", 
          RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], "-", 
         RowBox[{"X2", "[", 
          RowBox[{"i", ",", "i", ",", "w", ",", "w"}], "]"}]}], ")"}]}], " ", 
      "-", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Y1", "[", 
         RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], "-", 
        RowBox[{"Y2", "[", 
         RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Zbarpl", "[", 
      RowBox[{"i_", ",", "w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"omega", "[", "i", "]"}], " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X1", "[", 
          RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], "-", 
         RowBox[{"X2", "[", 
          RowBox[{"i", ",", "i", ",", "w", ",", "w"}], "]"}]}], ")"}]}], " ", 
      "+", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Y1", "[", 
         RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], "-", 
        RowBox[{"Y2", "[", 
         RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zbarpl", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"w", "^", "2"}], " ", 
       RowBox[{"P1", "[", 
        RowBox[{"w", ",", "w", ",", "i"}], "]"}]}], " ", "+", " ", 
      RowBox[{"B1", "[", 
       RowBox[{"w", ",", "w", ",", "i"}], "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.764174214160884*^9, 3.7641743156097393`*^9}, {
  3.764174375097384*^9, 3.76417441185166*^9}, {3.764174526461917*^9, 
  3.764174693086339*^9}, {3.764174775614067*^9, 3.76417477820973*^9}, {
  3.76417481076956*^9, 3.76417486060004*^9}, {3.7641755399624557`*^9, 
  3.76417563595829*^9}, {3.764176080076314*^9, 3.764176080563602*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Source", " ", "term", " ", "with", " ", "1", " ", "normalizable", " ", 
    "mode"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tbar", "[", 
     RowBox[{"w_", ",", "i_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"Zbarmin", "[", 
       RowBox[{"i", ",", "w", ",", "w", ",", "i"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"w", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"omega", "[", "i", "]"}], "+", "w"}], ")"}]}], ")"}]}], " ",
      "+", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"Zbarpl", "[", 
       RowBox[{"i", ",", "w", ",", "w", ",", "i"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"w", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"omega", "[", "i", "]"}], "-", "w"}], ")"}]}], ")"}]}], " ",
      "-", " ", 
     RowBox[{
      RowBox[{"H2", "[", 
       RowBox[{"w", ",", "i", ",", "w", ",", "i"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"omega", "[", "i", "]"}], ")"}], "^", "2"}], " ", "/", " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"omega", "[", "i", "]"}], ")"}], "^", "2"}], " ", "-", 
          " ", 
          RowBox[{"w", "^", "2"}]}], ")"}]}], ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"H1", "[", 
       RowBox[{"i", ",", "w", ",", "w", ",", "i"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{
          RowBox[{"w", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"omega", "[", "i", "]"}], ")"}], "^", "2"}], " ", "-", 
            " ", 
            RowBox[{"w", "^", "2"}]}], ")"}]}]}], " ", "-", " ", "1"}], 
       ")"}]}], " ", "+", " ", 
     RowBox[{"w", " ", 
      RowBox[{"omega", "[", "i", "]"}], " ", 
      RowBox[{"X1", "[", 
       RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "-", "w"}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "+", "w"}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{
         RowBox[{"omega", "[", "i", "]"}], "/", "w"}]}], ")"}]}], " ", "-", 
     " ", 
     RowBox[{
      RowBox[{"w", "^", "2"}], " ", 
      RowBox[{"X2", "[", 
       RowBox[{"i", ",", "i", ",", "w", ",", "w"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "-", "w"}], ")"}]}], " ", "-", 
        " ", 
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "+", "w"}], ")"}]}], " ", "+", 
        " ", "1"}], ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", "^", "2"}], " ", "/", "2"}], ")"}], 
      RowBox[{"V1", "[", 
       RowBox[{"i", ",", "i", ",", "w", ",", "w"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"omega", "[", "i", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "-", "w"}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{
         RowBox[{"omega", "[", "i", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "+", "w"}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{"5", "/", "2"}]}], ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", "^", "2"}], " ", "/", " ", "2"}], ")"}], " ", 
      RowBox[{"V2", "[", 
       RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], " ", "-", " ", "w"}], ")"}]}], 
        " ", "-", " ", 
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "+", "w"}], ")"}]}], " ", "-", 
        " ", "1"}], ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"omega", "[", "i", "]"}], ")"}], "^", "2"}], " ", 
      RowBox[{"zbarpl", "[", 
       RowBox[{"w", ",", "w", ",", "i"}], "]"}]}], " ", "-", " ", 
     RowBox[{"2", " ", 
      RowBox[{"w", "^", "2"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"omega", "[", "i", "]"}], ")"}], "^", "2"}], " ", 
      RowBox[{"P2", "[", 
       RowBox[{"i", ",", "i", ",", "w"}], "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"w", "^", "2"}], " ", 
      RowBox[{"M2", "[", 
       RowBox[{"i", ",", "i", ",", "w"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", " ", "w"}], ")"}], "^", "2"}], " ", 
      RowBox[{"Q2", "[", 
       RowBox[{"i", ",", "i", ",", "w"}], "]"}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.76340780485323*^9, 3.7634078187206593`*^9}, {
   3.763407950022196*^9, 3.763408084369021*^9}, {3.7634081306764812`*^9, 
   3.763408346009348*^9}, 3.763408520329237*^9, {3.763408907605022*^9, 
   3.763408908650311*^9}, {3.763409499975202*^9, 3.763409658297757*^9}, {
   3.763409708315423*^9, 3.7634097217572947`*^9}, {3.763409800415782*^9, 
   3.763409917074051*^9}, {3.763409951572667*^9, 3.763410114544826*^9}, 
   3.763410368186026*^9, {3.7634161526993647`*^9, 3.763416157793417*^9}, {
   3.763416191395714*^9, 3.763416195793302*^9}, {3.763498839326626*^9, 
   3.763498871712132*^9}, {3.763588357550825*^9, 3.763588387619866*^9}, {
   3.7635884405131073`*^9, 3.7635886681948977`*^9}, {3.764172607286242*^9, 
   3.764172640693892*^9}, {3.764174878120708*^9, 3.7641749092366343`*^9}, {
   3.76417494331067*^9, 3.764174994803638*^9}, {3.7641751008434057`*^9, 
   3.7641755259919233`*^9}, {3.764175741242498*^9, 3.764175803420519*^9}, {
   3.764175883221478*^9, 3.7641759045410223`*^9}}],

Cell[BoxData[
 RowBox[{"Tbar", "[", 
  RowBox[{"Pi", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.764175922461329*^9, 3.76417592930857*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrigExpand", "[", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "*", " ", "n"}], " ", "+", " ", 
    RowBox[{"w_i", " ", "*", " ", "t"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.764264386160407*^9, 3.7642644267946377`*^9}, 
   3.7642704417399406`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "n", "]"}], "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "w_i"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "w_i"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "n", "]"}], "2"]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", "n", "]"}], " ", 
   RowBox[{"Sin", "[", "n", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "w_i"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.764264427345439*^9, 3.764270443082777*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"2", "x"}], "]"}], 
    RowBox[{"Cos", "[", "x", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", 
     RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764264466848024*^9, 3.764264496721394*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7642644833163223`*^9, 3.7642644979433613`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrigReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Cos", "[", "z", "]"}], ")"}], "^", "2"}], " ", "-", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Sin", "[", "z", "]"}], ")"}], "^", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764270202251645*^9, 3.764270222338032*^9}}],

Cell[BoxData[
 RowBox[{"Cos", "[", 
  RowBox[{"2", " ", "z"}], "]"}]], "Output",
 CellChangeTimes->{3.764270222803937*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tan", "[", "x", "]"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"d", "-", "1"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Cos", "[", "x", "]"}], ")"}], "^", "Dpl"}], " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Dpl", " ", "+", " ", "w"}], ")"}], "/", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Dpl", "-", "w"}], ")"}], "/", "2"}], ",", " ", 
         RowBox[{"d", "/", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Sin", "[", "x", "]"}], ")"}], "^", "2"}]}], "]"}]}], 
      ")"}], "^", "2"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"w", ",", "0", ",", 
     RowBox[{"2", "Pi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"0.9", "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", 
     RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764180310750011*^9, 3.7641804365675163`*^9}, {
  3.764180471601898*^9, 3.764180477880101*^9}, {3.764199113948204*^9, 
  3.764199115978136*^9}}],

Cell[BoxData[
 Graphics3DBox[{},
  Axes->True,
  AxesLabel->{None, None, None},
  BoxRatios->{1, 1, 0.4},
  DisplayFunction->Identity,
  FaceGridsStyle->Automatic,
  ImageSize->{294.7035133470214, 279.4183962802844},
  Method->{"DefaultBoundaryStyle" -> Directive[
      GrayLevel[0.3]], "RotationControl" -> "Globe"},
  PlotRange->
   NCache[{{0, 2 Pi}, {1.413716694115407, Rational[1, 2] Pi}, {0., 0.}}, {{
     0, 6.283185307179586}, {1.413716694115407, 1.5707963267948966`}, {0., 
     0.}}],
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02], 
    Scaled[0.02]},
  Ticks->{Automatic, Automatic, Automatic},
  ViewPoint->{0.06249527417229583, -3.3119096949423907`, 0.6909041273958779},
  ViewVertical->{0., 0., 1.}]], "Output",
 CellChangeTimes->{3.7641803682849617`*^9, 3.764180402666333*^9, 
  3.764180437302341*^9, 3.76418048101178*^9, 3.7641991166962137`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{645, 737},
WindowMargins->{{93, Automatic}, {1, Automatic}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 552, 9, 134, "Section"],
Cell[1135, 33, 190, 3, 28, "Input"],
Cell[1328, 38, 898, 20, 80, "Input"],
Cell[2229, 60, 2589, 66, 114, "Input"],
Cell[4821, 128, 2253, 62, 131, "Input"],
Cell[7077, 192, 1303, 40, 97, "Input"],
Cell[8383, 234, 4828, 131, 267, "Input"],
Cell[13214, 367, 1758, 51, 131, "Input"],
Cell[14975, 420, 14450, 403, 896, "Input"],
Cell[29428, 825, 2547, 68, 165, "Input"],
Cell[31978, 895, 6258, 174, 250, "Input"],
Cell[38239, 1071, 146, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[38410, 1078, 316, 8, 28, "Input"],
Cell[38729, 1088, 563, 17, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39329, 1110, 336, 10, 28, "Input"],
Cell[39668, 1122, 98, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39803, 1128, 326, 9, 28, "Input"],
Cell[40132, 1139, 122, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40291, 1147, 1262, 38, 80, "Input"],
Cell[41556, 1187, 875, 22, 294, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
