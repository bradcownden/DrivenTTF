(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66947,       1795]
NotebookOptionsPosition[     64794,       1719]
NotebookOutlinePosition[     65151,       1735]
CellTagsIndexPosition[     65108,       1732]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Examining integrals that contribute to secular terms from non-normalizable + \
normalizable modes with massive scalars. \
\>", "Section",
 CellChangeTimes->{{3.7629062006142387`*^9, 3.762906202879053*^9}, {
  3.762906258734685*^9, 3.762906341592255*^9}, {3.762967655302238*^9, 
  3.762967692187183*^9}, {3.762967814805538*^9, 3.76296783044731*^9}, {
  3.762975123828157*^9, 3.76297513133952*^9}, {3.763498583027974*^9, 
  3.763498654029675*^9}, {3.763588143022334*^9, 3.763588148798937*^9}, {
  3.7641701522503242`*^9, 3.764170154427072*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.763074721190872*^9, 3.763074726412595*^9}, {
  3.763074758070485*^9, 3.76307477359044*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Inputs", ":", " ", 
     RowBox[{"number", " ", "of", " ", "spatial", " ", "dimensions", " ", 
      RowBox[{"(", "d", ")"}], " ", "of", " ", "the", " ", "bulk", " ", 
      "theory"}]}], ";", "  ", 
    RowBox[{"mass", " ", 
     RowBox[{"(", "m", ")"}], " ", "of", " ", "the", " ", "scalar", " ", 
     "field"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d", ":=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", " ", ":=", " ", 
     RowBox[{"2", "I"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.763498687025902*^9, 3.763498712250783*^9}, {
   3.763498985635792*^9, 3.763498991611847*^9}, {3.763499129886156*^9, 
   3.7634991689590807`*^9}, {3.7634992276852903`*^9, 
   3.7634992277797422`*^9}, {3.763499748536438*^9, 3.763499773999934*^9}, {
   3.763507651719101*^9, 3.7635076521746798`*^9}, 3.78171497073446*^9, {
   3.781715106743164*^9, 3.7817151133411303`*^9}, {3.781829374348324*^9, 
   3.781829374393223*^9}, {3.7819948509743834`*^9, 3.781994852889949*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m", "^", "2"}]], "Input",
 CellChangeTimes->{{3.781715122253777*^9, 3.781715122933074*^9}}],

Cell[BoxData[
 RowBox[{"-", "4"}]], "Output",
 CellChangeTimes->{3.781715123975827*^9, 3.781829377550859*^9, 
  3.781994855276815*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Helpful", " ", "secondary", " ", "functions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Dpl", " ", "=", " ", 
     RowBox[{
      RowBox[{"d", "/", "2"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"d", "^", "2"}], " ", "+", " ", 
         RowBox[{"4", 
          RowBox[{"m", "^", "2"}]}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dmin", " ", "=", " ", 
     RowBox[{
      RowBox[{"d", "/", "2"}], " ", "-", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"d", "^", "2"}], " ", "+", " ", 
         RowBox[{"4", 
          RowBox[{"m", "^", "2"}]}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"omega", "[", "i_", "]"}], ":=", 
     RowBox[{"Dpl", " ", "+", " ", 
      RowBox[{"2", "i"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mu", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Tan", "[", "x", "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nu", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}], "/", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], ",", "x"}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.762904629077486*^9, 3.762904633998115*^9}, 
   3.762975133476315*^9, {3.762975165437059*^9, 3.7629752663415737`*^9}, {
   3.7630744354069233`*^9, 3.763074435459634*^9}, {3.763075125911824*^9, 
   3.763075126214349*^9}, {3.7630751804440947`*^9, 3.7630751805306053`*^9}, {
   3.763157220689012*^9, 3.7631572213103952`*^9}, {3.7631573055706673`*^9, 
   3.763157332194145*^9}, {3.763161497774618*^9, 3.763161501260707*^9}, {
   3.763161659811837*^9, 3.763161659896862*^9}, {3.763161847928557*^9, 
   3.763161861031417*^9}, {3.763329572967142*^9, 3.7633295733761272`*^9}, {
   3.7634089940877*^9, 3.763409026493307*^9}, {3.7634139073691072`*^9, 
   3.763413907580092*^9}, {3.7634152222960243`*^9, 3.763415222494063*^9}, {
   3.763416911301551*^9, 3.763416911882235*^9}, {3.7634175633272448`*^9, 
   3.763417583569435*^9}, {3.763498549591984*^9, 3.763498561391902*^9}, 
   3.763498677017758*^9, {3.763498722395125*^9, 3.763498743235928*^9}, {
   3.764174348105587*^9, 3.764174355574226*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Normalizable", " ", "mode", " ", "basis", " ", "functions"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"k", "[", "i_", "]"}], ":=", 
     RowBox[{"2", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "+", 
          RowBox[{"Dpl", "/", "2"}]}], ")"}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"i", "+", "1"}], "]"}], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"i", "+", "Dpl"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Gamma", "[", 
            RowBox[{"i", "+", 
             RowBox[{"d", "/", "2"}]}], "]"}], 
           RowBox[{"Gamma", "[", 
            RowBox[{"i", "+", "Dpl", "-", 
             RowBox[{"d", "/", "2"}], "+", "1"}], "]"}]}], ")"}]}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"i_", ",", " ", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"k", "[", "i", "]"}], " ", 
      RowBox[{"JacobiP", "[", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"d", "/", "2"}], " ", "-", " ", "1"}], ",", 
        RowBox[{"Dpl", "-", 
         RowBox[{"d", "/", "2"}]}], ",", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "x"}], "]"}]}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cos", "[", "x", "]"}], ")"}], "^", "Dpl"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ep", "[", 
      RowBox[{"i_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"i", ",", "x"}], "]"}], ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"N", "[", 
    RowBox[{"e", "[", 
     RowBox[{"2", ",", 
      RowBox[{"Pi", "/", "4"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.762967865719746*^9, 3.762967871255427*^9}, {
  3.762969521826351*^9, 3.762969542679894*^9}, {3.762975320797474*^9, 
  3.762975376145011*^9}, {3.76341446148372*^9, 3.763414566876734*^9}, {
  3.763414777581973*^9, 3.763414799850561*^9}, {3.76349839408307*^9, 
  3.763498492627866*^9}, {3.76349894885436*^9, 3.7634989489417477`*^9}, {
  3.7634990663461647`*^9, 3.763499078366103*^9}, {3.763499397625011*^9, 
  3.763499399912448*^9}, {3.7634996111706867`*^9, 3.763499623562582*^9}, {
  3.781387272924203*^9, 3.781387308605124*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.8660254037844386`"}]], "Output",
 CellChangeTimes->{{3.78138730017806*^9, 3.781387309213893*^9}, 
   3.781715132523018*^9, 3.781829382619969*^9, 3.781994859293508*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Non", "-", 
    RowBox[{"normalizable", " ", "mode", " ", "basis", " ", "function", " ", 
     RowBox[{"(", 
      RowBox[{"Nastase", " ", "12.28"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"nn", "[", 
      RowBox[{"w_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cos", "[", "x", "]"}], ")"}], "^", "Dpl"}], " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Dpl", " ", "+", " ", "w"}], ")"}], "/", "2"}], ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Dpl", "-", "w"}], ")"}], "/", "2"}], ",", " ", 
        RowBox[{"d", "/", "2"}], ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sin", "[", "x", "]"}], ")"}], "^", "2"}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nnp", "[", 
      RowBox[{"w_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"nn", "[", 
        RowBox[{"w", ",", "x"}], "]"}], ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"nn", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Pi", "/", "4"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7635881616888437`*^9, 3.763588311193657*^9}, 
   3.764177191308857*^9, {3.781387374294671*^9, 3.781387385516182*^9}}],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.781387386356451*^9, 3.781715138837817*^9, 
  3.7818293853973713`*^9, 3.781994861256165*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Integrals", " ", "that", " ", "appear", " ", "in", " ", "the", " ", 
     "expression", " ", "for", " ", "the", " ", "third"}], "-", 
    RowBox[{"order", " ", "source", " ", "term"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"V", "[", 
      RowBox[{"i_", ",", " ", "j_", ",", " ", "k_", ",", " ", "l_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"j", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"k", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"l", ",", "x"}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sec", "[", "x", "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"j", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"k", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"l", ",", "x"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Y", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"j", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"k", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"l", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"nu", "[", "x", "]"}], ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"j", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"k", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"l", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyFtIk2EAh/GPYjSnzciEAsMma4NBd2suFdGgmKJRa+3Q0lgglrWNNROb
mJFNJLxY5mFDUBhGAxWVFjMEFQ/bZLC6iFxlFlvUp2womrC+SHv/78XDDx7R
Lau67gDDMBISlIVcuQWCZLlMl18Bp8b9DjGxZPlQC4y+HtqE131L27Cl/kHG
aaL38Cw13sZmQ7u++SgUyrvWq4nivRGqIeOy/BKx/0cbtb0vpIQvWX4xVI66
z6uJGyvsBfhwwqSGujWbBp4ost6FHzVvqK8aWp1QLZd0wn/jyj44nIhQtyyB
Abj3rMoHs04K/DC97wzAjtYv09B1fHcGCpr13+Bj6fcN+FlVwcG5xhrmKjGc
yi+Ghj8c9VP6qwXOGH9ZoUPinYedhd2L0GSOh2Ewl41CPk/6ATIucYzaFF6n
P7CagokAuw1jvLHf0MK7w0Eur/EvXFDdOKghRtpvZkLm3JljsHRnXgQruXdS
ONjRr4AK46YKOsz2Sih82nMNlr0f08IjOdr7sEt0xQ4vbhW54KPas8/hvUlt
LzSKZ6n7t0ve9mYmy6sSsiAUcLYoLP3ppK56hINuotexS13beXLKQ5x6ERHB
/5d5EoQ=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Helpful", " ", "combinations", " ", "of", " ", "X", " ", "and", " ", 
    "Y"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Zpl", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"omega", "[", "i", "]"}], 
       RowBox[{"omega", "[", "j", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"k", ",", "l", ",", "i", ",", "j"}], "]"}], "-", 
         RowBox[{"X", "[", 
          RowBox[{"l", ",", "k", ",", "i", ",", "j"}], "]"}]}], ")"}]}], " ", 
      "+", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"i", ",", "j", ",", "l", ",", "k"}], "]"}], "-", 
        RowBox[{"Y", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Zmin", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"omega", "[", "i", "]"}], 
       RowBox[{"omega", "[", "j", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"k", ",", "l", ",", "i", ",", "j"}], "]"}], "-", 
         RowBox[{"X", "[", 
          RowBox[{"l", ",", "k", ",", "i", ",", "j"}], "]"}]}], ")"}]}], " ", 
      "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"i", ",", "j", ",", "l", ",", "k"}], "]"}], "-", 
        RowBox[{"Y", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.763499437301585*^9, 3.763499465093074*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Integrals", " ", "evaluated", " ", "for", " ", "combinations", " ", "of",
      " ", "normalizable", " ", "and", " ", "non"}], "-", 
    RowBox[{"normalizable", " ", "modes"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"X1", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"X2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Y1", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Y2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"V1", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], " ", 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sec", "[", "x", "]"}], ")"}], "^", "2"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"V2", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sec", "[", "x", "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H1", "[", 
      RowBox[{"i_", ",", "w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"nu", "[", "x", "]"}], ",", "x"}], "]"}], " ", 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H2", "[", 
      RowBox[{"w_", ",", "i_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mu", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"nu", "[", "x", "]"}], ",", "x"}], "]"}], " ", 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], " ", 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nn", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"mu", "[", "y", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"e", "[", 
           RowBox[{"i", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"mu", "[", "y", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nn", "[", 
           RowBox[{"w", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"B1", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"nnp", "[", 
         RowBox[{"w", ",", "x"}], "]"}], 
        RowBox[{"mu", "[", "y", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"e", "[", 
           RowBox[{"i", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"B2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"mu", "[", "y", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nn", "[", 
           RowBox[{"w", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"M2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"nu", "[", "x", "]"}], ",", "x"}], "]"}], 
        RowBox[{"ep", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"mu", "[", "y", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nn", "[", 
           RowBox[{"w", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q2", "[", 
      RowBox[{"i_", ",", "i_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "x", "]"}], 
        RowBox[{"nu", "[", "x", "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "x"}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sec", "[", "x", "]"}], ")"}], "^", "2"}], " ", 
        RowBox[{"mu", "[", "y", "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nn", "[", 
           RowBox[{"w", ",", "y"}], "]"}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", "\"\<LocalAdaptive\>\"", "}"}]}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "20"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.764170361938056*^9, 3.764170904376463*^9}, 
   3.7641726456621847`*^9, {3.764172761461997*^9, 3.7641731438881893`*^9}, {
   3.764174448645485*^9, 3.764174468620513*^9}, {3.764175006726725*^9, 
   3.7641750912574587`*^9}, {3.764175645291501*^9, 3.7641757298436213`*^9}, {
   3.7641758085332127`*^9, 3.764175874694023*^9}, {3.764176000689888*^9, 
   3.764176001224359*^9}, {3.764176128971127*^9, 3.764176177082803*^9}, {
   3.76417720857195*^9, 3.764177214351563*^9}, {3.764177247239451*^9, 
   3.7641772905064373`*^9}, {3.781387204436894*^9, 3.781387243714707*^9}, {
   3.781387497673294*^9, 3.781387498831822*^9}, {3.781549028095522*^9, 
   3.781549028174151*^9}, 3.781549074064999*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Write", " ", "some", " ", "integral", " ", "values", " ", "to", " ", "a", 
   " ", "file", " ", "to", " ", "be", " ", "imported", " ", "by", " ", 
   "\[IndentingNewLine]", "the", " ", "main", " ", "python", " ", "program"}],
   " ", "*)"}]], "Input",
 CellChangeTimes->{{3.781389491363649*^9, 3.7813895145957127`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ws", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{"i", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0.25", ",", "4.0", ",", "0.25"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7818941755805063`*^9, 3.7818942232742767`*^9}, 
   3.781899058011346*^9, {3.7819066085033617`*^9, 3.781906611047193*^9}, {
   3.7819076729703913`*^9, 3.781907677137795*^9}, {3.78199283900756*^9, 
   3.78199284293423*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.25`", ",", "0.5`", ",", "0.75`", ",", "1.`", ",", "1.25`", ",", "1.5`", 
   ",", "1.75`", ",", "2.`", ",", "2.25`", ",", "2.5`", ",", "2.75`", ",", 
   "3.`", ",", "3.25`", ",", "3.5`", ",", "3.75`", ",", "4.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7819948851671352`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bees", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"B2", "[", 
      RowBox[{
       RowBox[{"i", "-", "1"}], ",", 
       RowBox[{"i", "-", "1"}], ",", 
       RowBox[{"ws", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "ws", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "11"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781389525595931*^9, 3.7813897858906403`*^9}, 
   3.78138987265672*^9, {3.781389940429755*^9, 3.7813900830603848`*^9}, {
   3.78139015168968*^9, 3.781390219884159*^9}, {3.781390492964506*^9, 
   3.781390504851303*^9}, {3.781390566916707*^9, 3.781390739364369*^9}, {
   3.781390822053361*^9, 3.781390829739644*^9}, {3.781562025993454*^9, 
   3.781562078305333*^9}, {3.781651790610186*^9, 3.78165185731398*^9}, {
   3.781715175208568*^9, 3.7817151786072483`*^9}, {3.781718076427864*^9, 
   3.781718229077979*^9}, {3.7817182690073853`*^9, 3.781718276094838*^9}, {
   3.7818292138229218`*^9, 3.781829268714102*^9}, {3.781829301377583*^9, 
   3.781829363419434*^9}, {3.781829422024037*^9, 3.7818294255955963`*^9}, {
   3.781831204153062*^9, 3.781831212497993*^9}, {3.781894242674324*^9, 
   3.7818943258539877`*^9}, {3.781894361344613*^9, 3.781894378416656*^9}, {
   3.7818944668596478`*^9, 3.7818944697008963`*^9}, {3.781895441936384*^9, 
   3.781895447840767*^9}, {3.781899560455564*^9, 3.781899587768849*^9}, {
   3.78189962143502*^9, 3.781899638368966*^9}, {3.781899891083735*^9, 
   3.7818998939176292`*^9}, 3.781900017442109*^9, {3.7819063091356583`*^9, 
   3.781906321614393*^9}, {3.781906355344681*^9, 3.78190635825711*^9}, {
   3.781906600654291*^9, 3.781906601733678*^9}, {3.781906653194462*^9, 
   3.7819066590228643`*^9}, 3.781906698165327*^9, {3.78190772666987*^9, 
   3.78190772857967*^9}, {3.781916898249783*^9, 3.781916898780561*^9}, 
   3.7819931294676847`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "list"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"B2", "[", 
     RowBox[{"0", ",", "0", ",", "0.25"}], "]"}], ",", 
    RowBox[{"B2", "[", 
     RowBox[{"1", ",", "1", ",", "0.25"}], "]"}], ",", 
    RowBox[{"B2", "[", 
     RowBox[{"2", ",", "2", ",", "0.25"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.781906706304915*^9, 3.781906740589909*^9}, {
  3.781907737327354*^9, 3.781907746766634*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.0316425531275393`", ",", "1.7792770452515179`", ",", 
   "2.8708141185842786`"}], "}"}]], "Output",
 CellChangeTimes->{3.781906742105068*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"output", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Join", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ws", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"Bees", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ws", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\</Users/bradc/Research/DrivenTTF/data/Bvalues.txt\>\"", ",", "output", 
   ",", "\"\<CSV\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.781894473712476*^9, 3.781894482734486*^9}, {
   3.781894559096178*^9, 3.781894571080727*^9}, {3.7818949443469543`*^9, 
   3.781894948049491*^9}, {3.781895040703075*^9, 3.7818950444311438`*^9}, {
   3.781895163344378*^9, 3.78189520818972*^9}, 3.781895252569579*^9, {
   3.781895289603125*^9, 3.781895329568345*^9}, {3.7818953737561607`*^9, 
   3.781895415134515*^9}, {3.7819064026963367`*^9, 3.7819064160675364`*^9}, {
   3.781906477197995*^9, 3.7819064893733597`*^9}, {3.781906531578772*^9, 
   3.7819065605303087`*^9}, {3.781906836735045*^9, 3.781906917255826*^9}, {
   3.781906957075189*^9, 3.7819069618422537`*^9}, {3.781907027580996*^9, 
   3.78190705988153*^9}, {3.78190710383541*^9, 3.7819071180747347`*^9}, {
   3.781907166685912*^9, 3.7819071942697763`*^9}, {3.781907233270266*^9, 
   3.781907258871213*^9}, {3.781907313700885*^9, 3.781907321403693*^9}, {
   3.781907361944138*^9, 3.781907422778112*^9}, {3.781907482653454*^9, 
   3.781907520959322*^9}, {3.781907568684039*^9, 3.7819075750735807`*^9}, 
   3.781993134537365*^9, {3.7819951197374697`*^9, 3.78199512004951*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ques", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Q2", "[", 
      RowBox[{
       RowBox[{"i", "-", "1"}], ",", 
       RowBox[{"i", "-", "1"}], ",", 
       RowBox[{"ws", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "ws", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "11"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781895541311975*^9, 3.7818955427920313`*^9}, {
   3.781895937817485*^9, 3.7818959387911987`*^9}, {3.7819078005847387`*^9, 
   3.7819078155419073`*^9}, {3.781917259198834*^9, 3.7819172606732597`*^9}, {
   3.781917478602878*^9, 3.7819174792407103`*^9}, 3.7819931381449747`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.1241388168210388`", ",", "0.15676141842812716`", ",", 
     "0.1700984008673459`", ",", "0.17684804773898188`", ",", 
     "0.18073473333816897`", ",", "0.18317682556671352`", ",", 
     "0.1848111891825309`", ",", "0.18595860050352714`", ",", 
     "0.18679511114245623`", ",", "0.18742368831694706`", ",", 
     "0.18790792499697795`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.12159446917213793`", ",", "0.15214191410287356`", ",", 
     "0.16445507983660856`", ",", "0.17064275715966234`", ",", 
     "0.17419076007451373`", ",", "0.1764137048739024`", ",", 
     "0.1778983710689223`", ",", "0.17893910347979997`", ",", 
     "0.17969691274201197`", ",", "0.18026581738037642`", ",", 
     "0.1807037359191767`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.11748197573041114`", ",", "0.14475421957427712`", ",", 
     "0.1554782785568909`", ",", "0.1608003973891685`", ",", 
     "0.16382899482605823`", ",", "0.16571682571650886`", ",", 
     "0.1669730295824817`", ",", "0.1678511664517701`", ",", 
     "0.16848920022708996`", ",", "0.16896735200702656`", ",", 
     "0.169334879105228`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.11198306565837945`", ",", "0.13503410040123295`", ",", 
     "0.14376237579238638`", ",", "0.1480102346695416`", ",", 
     "0.15039854669100933`", ",", "0.15187508310169395`", ",", 
     "0.15285175167636797`", ",", "0.1535314688267084`", ",", 
     "0.15402347130473712`", ",", "0.15439117984007442`", ",", 
     "0.15467315449726365`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.10533272465746657`", ",", "0.1235328186621904`", ",", 
     "0.13004913745825067`", ",", "0.13312587040169202`", ",", 
     "0.13482273908786224`", ",", "0.13585785093581876`", ",", 
     "0.13653582380821064`", ",", "0.13700408311554432`", ",", 
     "0.1373409881066196`", ",", "0.13759157676974748`", ",", 
     "0.13778296082219363`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0978018489460816`", ",", "0.1108673873112861`", ",", 
     "0.11515266116965958`", ",", "0.11707391105500506`", ",", 
     "0.11809716241402111`", ",", "0.11870578614364637`", ",", 
     "0.11909681628035301`", ",", "0.11936286850479165`", ",", 
     "0.11955195717749953`", ",", "0.11969121094850688`", ",", 
     "0.11979666572009963`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0896786728395112`", ",", "0.09766683256516805`", ",", 
     "0.09988187742148993`", ",", "0.10076116619205447`", ",", 
     "0.10118712414378161`", ",", "0.10142173933585673`", ",", 
     "0.10156317203137677`", ",", "0.10165432495222375`", ",", 
     "0.1017161580579824`", ",", "0.10175992856498962`", ",", 
     "0.1017919030755017`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.08125001508533124`", ",", "0.08452381030484758`", ",", 
     "0.08497023793077002`", ",", "0.08499278656300543`", ",", 
     "0.08493868457973552`", ",", "0.08487727615663221`", ",", 
     "0.08482328787716752`", ",", "0.08477867055123947`", ",", 
     "0.08474235393500083`", ",", "0.08471285170904062`", ",", 
     "0.08468869044755889`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.07278449472246415`", ",", "0.07195125220996416`", ",", 
     "0.07102082442067077`", ",", "0.07041088131258981`", ",", 
     "0.07001382938890308`", ",", "0.06974570514523766`", ",", 
     "0.06955750903895414`", ",", "0.069420843817554`", ",", 
     "0.06931868696327255`", ",", "0.0692403926320821`", ",", 
     "0.06917912721868968`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06451879737765899`", ",", "0.0603534142995734`", ",", 
     "0.0584719147774163`", ",", "0.057459578670845654`", ",", 
     "0.056856015443817715`", ",", "0.05646832995438009`", ",", 
     "0.0562048558451207`", ",", "0.05601783159886624`", ",", 
     "0.05588035365751132`", ",", "0.05577635118401096`", ",", 
     "0.05569579381271532`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.056647891259293225`", ",", "0.050009908253001625`", ",", 
     "0.047584922066908245`", ",", "0.046377685459479595`", ",", 
     "0.04568660135658975`", ",", "0.04525370933400158`", ",", 
     "0.04496452293075576`", ",", "0.04476175170325329`", ",", 
     "0.044614106474996265`", ",", "0.04450323893535135`", ",", 
     "0.044417872588008646`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.049319742021684`", ",", "0.04107384712296408`", ",", 
     "0.03845319412119311`", ",", "0.037216048304406654`", ",", 
     "0.03652819846273844`", ",", "0.036105244434396125`", ",", 
     "0.035826316216055046`", ",", "0.035632580464980815`", ",", 
     "0.0354925380860648`", ",", "0.035387983322676016`", ",", 
     "0.03530785331427344`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.042634237024711905`", ",", "0.03358222592693808`", ",", 
     "0.03102743253961311`", ",", "0.02987325299716903`", ",", 
     "0.029247062865852096`", ",", "0.028868045570180547`", ",", 
     "0.028620828497327683`", ",", "0.028450508790479535`", ",", 
     "0.028328170602980852`", ",", "0.0282372828609407`", ",", 
     "0.028167910090356345`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.03664581767440185`", ",", "0.027475550186402978`", ",", 
     "0.025151832861464447`", ",", "0.02414168568425405`", ",", 
     "0.023605219956818243`", ",", "0.02328491424073775`", ",", 
     "0.02307799133587031`", ",", "0.022936423386859646`", ",", 
     "0.022835290443208676`", ",", "0.02276047962090811`", ",", 
     "0.02270357523787018`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.03136900014178909`", ",", "0.02262297056698842`", ",", 
     "0.020604431631117342`", ",", "0.01975572356487245`", ",", 
     "0.01931296424524631`", ",", "0.01905152457167211`", ",", 
     "0.018883914094459834`", ",", "0.018769889004822838`", ",", 
     "0.018688754104014677`", ",", "0.01862894124727425`", ",", 
     "0.018583565842247192`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.026785714456268123`", ",", "0.018849206507023788`", ",", 
     "0.01713564104284787`", ",", "0.016434951287412895`", ",", 
     "0.016074209939431865`", ",", "0.015862814712676133`", ",", 
     "0.01572795225365374`", ",", "0.015636517861465665`", ",", 
     "0.0155716179920069`", ",", "0.015523864559164144`", ",", 
     "0.015487692532897524`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.781908144874864*^9, 3.781917407959669*^9, 
  3.7819176716001053`*^9, 3.781993057273*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"output", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Join", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ws", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"Ques", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ws", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\</Users/bradc/Research/DrivenTTF/data/Qvalues.txt\>\"", ",", "output", 
   ",", "\"\<CSV\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.781895641326221*^9, 3.7818956439647818`*^9}, {
   3.7819078318833447`*^9, 3.781907836496051*^9}, 3.7819931410568857`*^9, {
   3.7819950970167093`*^9, 3.781995097624758*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.25`", ",", "0.1241388168210388`", ",", "0.15676141842812716`", ",", 
     "0.1700984008673459`", ",", "0.17684804773898188`", ",", 
     "0.18073473333816897`", ",", "0.18317682556671352`", ",", 
     "0.1848111891825309`", ",", "0.18595860050352714`", ",", 
     "0.18679511114245623`", ",", "0.18742368831694706`", ",", 
     "0.18790792499697795`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.5`", ",", "0.12159446917213793`", ",", "0.15214191410287356`", ",", 
     "0.16445507983660856`", ",", "0.17064275715966234`", ",", 
     "0.17419076007451373`", ",", "0.1764137048739024`", ",", 
     "0.1778983710689223`", ",", "0.17893910347979997`", ",", 
     "0.17969691274201197`", ",", "0.18026581738037642`", ",", 
     "0.1807037359191767`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.75`", ",", "0.11748197573041114`", ",", "0.14475421957427712`", ",", 
     "0.1554782785568909`", ",", "0.1608003973891685`", ",", 
     "0.16382899482605823`", ",", "0.16571682571650886`", ",", 
     "0.1669730295824817`", ",", "0.1678511664517701`", ",", 
     "0.16848920022708996`", ",", "0.16896735200702656`", ",", 
     "0.169334879105228`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.11198306565837945`", ",", "0.13503410040123295`", ",", 
     "0.14376237579238638`", ",", "0.1480102346695416`", ",", 
     "0.15039854669100933`", ",", "0.15187508310169395`", ",", 
     "0.15285175167636797`", ",", "0.1535314688267084`", ",", 
     "0.15402347130473712`", ",", "0.15439117984007442`", ",", 
     "0.15467315449726365`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.25`", ",", "0.10533272465746657`", ",", "0.1235328186621904`", ",", 
     "0.13004913745825067`", ",", "0.13312587040169202`", ",", 
     "0.13482273908786224`", ",", "0.13585785093581876`", ",", 
     "0.13653582380821064`", ",", "0.13700408311554432`", ",", 
     "0.1373409881066196`", ",", "0.13759157676974748`", ",", 
     "0.13778296082219363`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.5`", ",", "0.0978018489460816`", ",", "0.1108673873112861`", ",", 
     "0.11515266116965958`", ",", "0.11707391105500506`", ",", 
     "0.11809716241402111`", ",", "0.11870578614364637`", ",", 
     "0.11909681628035301`", ",", "0.11936286850479165`", ",", 
     "0.11955195717749953`", ",", "0.11969121094850688`", ",", 
     "0.11979666572009963`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.75`", ",", "0.0896786728395112`", ",", "0.09766683256516805`", ",", 
     "0.09988187742148993`", ",", "0.10076116619205447`", ",", 
     "0.10118712414378161`", ",", "0.10142173933585673`", ",", 
     "0.10156317203137677`", ",", "0.10165432495222375`", ",", 
     "0.1017161580579824`", ",", "0.10175992856498962`", ",", 
     "0.1017919030755017`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.`", ",", "0.08125001508533124`", ",", "0.08452381030484758`", ",", 
     "0.08497023793077002`", ",", "0.08499278656300543`", ",", 
     "0.08493868457973552`", ",", "0.08487727615663221`", ",", 
     "0.08482328787716752`", ",", "0.08477867055123947`", ",", 
     "0.08474235393500083`", ",", "0.08471285170904062`", ",", 
     "0.08468869044755889`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.25`", ",", "0.07278449472246415`", ",", "0.07195125220996416`", ",", 
     "0.07102082442067077`", ",", "0.07041088131258981`", ",", 
     "0.07001382938890308`", ",", "0.06974570514523766`", ",", 
     "0.06955750903895414`", ",", "0.069420843817554`", ",", 
     "0.06931868696327255`", ",", "0.0692403926320821`", ",", 
     "0.06917912721868968`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.5`", ",", "0.06451879737765899`", ",", "0.0603534142995734`", ",", 
     "0.0584719147774163`", ",", "0.057459578670845654`", ",", 
     "0.056856015443817715`", ",", "0.05646832995438009`", ",", 
     "0.0562048558451207`", ",", "0.05601783159886624`", ",", 
     "0.05588035365751132`", ",", "0.05577635118401096`", ",", 
     "0.05569579381271532`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.75`", ",", "0.056647891259293225`", ",", "0.050009908253001625`", ",", 
     "0.047584922066908245`", ",", "0.046377685459479595`", ",", 
     "0.04568660135658975`", ",", "0.04525370933400158`", ",", 
     "0.04496452293075576`", ",", "0.04476175170325329`", ",", 
     "0.044614106474996265`", ",", "0.04450323893535135`", ",", 
     "0.044417872588008646`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.`", ",", "0.049319742021684`", ",", "0.04107384712296408`", ",", 
     "0.03845319412119311`", ",", "0.037216048304406654`", ",", 
     "0.03652819846273844`", ",", "0.036105244434396125`", ",", 
     "0.035826316216055046`", ",", "0.035632580464980815`", ",", 
     "0.0354925380860648`", ",", "0.035387983322676016`", ",", 
     "0.03530785331427344`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.25`", ",", "0.042634237024711905`", ",", "0.03358222592693808`", ",", 
     "0.03102743253961311`", ",", "0.02987325299716903`", ",", 
     "0.029247062865852096`", ",", "0.028868045570180547`", ",", 
     "0.028620828497327683`", ",", "0.028450508790479535`", ",", 
     "0.028328170602980852`", ",", "0.0282372828609407`", ",", 
     "0.028167910090356345`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.5`", ",", "0.03664581767440185`", ",", "0.027475550186402978`", ",", 
     "0.025151832861464447`", ",", "0.02414168568425405`", ",", 
     "0.023605219956818243`", ",", "0.02328491424073775`", ",", 
     "0.02307799133587031`", ",", "0.022936423386859646`", ",", 
     "0.022835290443208676`", ",", "0.02276047962090811`", ",", 
     "0.02270357523787018`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.75`", ",", "0.03136900014178909`", ",", "0.02262297056698842`", ",", 
     "0.020604431631117342`", ",", "0.01975572356487245`", ",", 
     "0.01931296424524631`", ",", "0.01905152457167211`", ",", 
     "0.018883914094459834`", ",", "0.018769889004822838`", ",", 
     "0.018688754104014677`", ",", "0.01862894124727425`", ",", 
     "0.018583565842247192`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.`", ",", "0.026785714456268123`", ",", "0.018849206507023788`", ",", 
     "0.01713564104284787`", ",", "0.016434951287412895`", ",", 
     "0.016074209939431865`", ",", "0.015862814712676133`", ",", 
     "0.01572795225365374`", ",", "0.015636517861465665`", ",", 
     "0.0155716179920069`", ",", "0.015523864559164144`", ",", 
     "0.015487692532897524`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.781908235444181*^9, 3.781917408569366*^9, 
  3.781917797251851*^9, 3.7819930573253393`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B2", "[", 
  RowBox[{"0", ",", "0", ",", "0.1"}], "]"}]], "Input",
 CellChangeTimes->{{3.781387143178055*^9, 3.781387149261217*^9}}],

Cell[BoxData["1.0386580227943094`"], "Output",
 CellChangeTimes->{3.781387150070619*^9, 3.781387509210813*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Combinations", " ", "of", " ", "integrals", " ", "evaluated", " ", "for",
      " ", "combinations", " ", "of", " ", "normalizable", " ", "and", " ", 
     "non"}], "-", 
    RowBox[{"normalizable", " ", "modes"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Zbarmin", "[", 
      RowBox[{"i_", ",", "w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"omega", "[", "i", "]"}], " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X1", "[", 
          RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], "-", 
         RowBox[{"X2", "[", 
          RowBox[{"i", ",", "i", ",", "w", ",", "w"}], "]"}]}], ")"}]}], " ", 
      "-", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Y1", "[", 
         RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], "-", 
        RowBox[{"Y2", "[", 
         RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Zbarpl", "[", 
      RowBox[{"i_", ",", "w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"omega", "[", "i", "]"}], " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X1", "[", 
          RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], "-", 
         RowBox[{"X2", "[", 
          RowBox[{"i", ",", "i", ",", "w", ",", "w"}], "]"}]}], ")"}]}], " ", 
      "+", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Y1", "[", 
         RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], "-", 
        RowBox[{"Y2", "[", 
         RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zbarpl", "[", 
      RowBox[{"w_", ",", "w_", ",", "i_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"w", "^", "2"}], " ", 
       RowBox[{"P1", "[", 
        RowBox[{"w", ",", "w", ",", "i"}], "]"}]}], " ", "+", " ", 
      RowBox[{"B1", "[", 
       RowBox[{"w", ",", "w", ",", "i"}], "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.764174214160884*^9, 3.7641743156097393`*^9}, {
  3.764174375097384*^9, 3.76417441185166*^9}, {3.764174526461917*^9, 
  3.764174693086339*^9}, {3.764174775614067*^9, 3.76417477820973*^9}, {
  3.76417481076956*^9, 3.76417486060004*^9}, {3.7641755399624557`*^9, 
  3.76417563595829*^9}, {3.764176080076314*^9, 3.764176080563602*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Source", " ", "term", " ", "with", " ", "1", " ", "normalizable", " ", 
    "mode"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tbar", "[", 
     RowBox[{"w_", ",", "i_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"Zbarmin", "[", 
       RowBox[{"i", ",", "w", ",", "w", ",", "i"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"w", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"omega", "[", "i", "]"}], "+", "w"}], ")"}]}], ")"}]}], " ",
      "+", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"Zbarpl", "[", 
       RowBox[{"i", ",", "w", ",", "w", ",", "i"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"w", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"omega", "[", "i", "]"}], "-", "w"}], ")"}]}], ")"}]}], " ",
      "-", " ", 
     RowBox[{
      RowBox[{"H2", "[", 
       RowBox[{"w", ",", "i", ",", "w", ",", "i"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"omega", "[", "i", "]"}], ")"}], "^", "2"}], " ", "/", " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"omega", "[", "i", "]"}], ")"}], "^", "2"}], " ", "-", 
          " ", 
          RowBox[{"w", "^", "2"}]}], ")"}]}], ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"H1", "[", 
       RowBox[{"i", ",", "w", ",", "w", ",", "i"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{
          RowBox[{"w", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"omega", "[", "i", "]"}], ")"}], "^", "2"}], " ", "-", 
            " ", 
            RowBox[{"w", "^", "2"}]}], ")"}]}]}], " ", "-", " ", "1"}], 
       ")"}]}], " ", "+", " ", 
     RowBox[{"w", " ", 
      RowBox[{"omega", "[", "i", "]"}], " ", 
      RowBox[{"X1", "[", 
       RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "-", "w"}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "+", "w"}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{
         RowBox[{"omega", "[", "i", "]"}], "/", "w"}]}], ")"}]}], " ", "-", 
     " ", 
     RowBox[{
      RowBox[{"w", "^", "2"}], " ", 
      RowBox[{"X2", "[", 
       RowBox[{"i", ",", "i", ",", "w", ",", "w"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "-", "w"}], ")"}]}], " ", "-", 
        " ", 
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "+", "w"}], ")"}]}], " ", "+", 
        " ", "1"}], ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", "^", "2"}], " ", "/", "2"}], ")"}], 
      RowBox[{"V1", "[", 
       RowBox[{"i", ",", "i", ",", "w", ",", "w"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"omega", "[", "i", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "-", "w"}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{
         RowBox[{"omega", "[", "i", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "+", "w"}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{"5", "/", "2"}]}], ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", "^", "2"}], " ", "/", " ", "2"}], ")"}], " ", 
      RowBox[{"V2", "[", 
       RowBox[{"w", ",", "w", ",", "i", ",", "i"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], " ", "-", " ", "w"}], ")"}]}], 
        " ", "-", " ", 
        RowBox[{"w", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"omega", "[", "i", "]"}], "+", "w"}], ")"}]}], " ", "-", 
        " ", "1"}], ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"omega", "[", "i", "]"}], ")"}], "^", "2"}], " ", 
      RowBox[{"zbarpl", "[", 
       RowBox[{"w", ",", "w", ",", "i"}], "]"}]}], " ", "-", " ", 
     RowBox[{"2", " ", 
      RowBox[{"w", "^", "2"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"omega", "[", "i", "]"}], ")"}], "^", "2"}], " ", 
      RowBox[{"P2", "[", 
       RowBox[{"i", ",", "i", ",", "w"}], "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"w", "^", "2"}], " ", 
      RowBox[{"M2", "[", 
       RowBox[{"i", ",", "i", ",", "w"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", " ", "w"}], ")"}], "^", "2"}], " ", 
      RowBox[{"Q2", "[", 
       RowBox[{"i", ",", "i", ",", "w"}], "]"}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.76340780485323*^9, 3.7634078187206593`*^9}, {
   3.763407950022196*^9, 3.763408084369021*^9}, {3.7634081306764812`*^9, 
   3.763408346009348*^9}, 3.763408520329237*^9, {3.763408907605022*^9, 
   3.763408908650311*^9}, {3.763409499975202*^9, 3.763409658297757*^9}, {
   3.763409708315423*^9, 3.7634097217572947`*^9}, {3.763409800415782*^9, 
   3.763409917074051*^9}, {3.763409951572667*^9, 3.763410114544826*^9}, 
   3.763410368186026*^9, {3.7634161526993647`*^9, 3.763416157793417*^9}, {
   3.763416191395714*^9, 3.763416195793302*^9}, {3.763498839326626*^9, 
   3.763498871712132*^9}, {3.763588357550825*^9, 3.763588387619866*^9}, {
   3.7635884405131073`*^9, 3.7635886681948977`*^9}, {3.764172607286242*^9, 
   3.764172640693892*^9}, {3.764174878120708*^9, 3.7641749092366343`*^9}, {
   3.76417494331067*^9, 3.764174994803638*^9}, {3.7641751008434057`*^9, 
   3.7641755259919233`*^9}, {3.764175741242498*^9, 3.764175803420519*^9}, {
   3.764175883221478*^9, 3.7641759045410223`*^9}}],

Cell[BoxData[
 RowBox[{"Tbar", "[", 
  RowBox[{"Pi", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.764175922461329*^9, 3.76417592930857*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrigExpand", "[", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "*", " ", "n"}], " ", "+", " ", 
    RowBox[{"w_i", " ", "*", " ", "t"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.764264386160407*^9, 3.7642644267946377`*^9}, 
   3.7642704417399406`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "n", "]"}], "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "w_i"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "w_i"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "n", "]"}], "2"]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", "n", "]"}], " ", 
   RowBox[{"Sin", "[", "n", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "w_i"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.764264427345439*^9, 3.764270443082777*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"2", "x"}], "]"}], 
    RowBox[{"Cos", "[", "x", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", 
     RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764264466848024*^9, 3.764264496721394*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7642644833163223`*^9, 3.7642644979433613`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrigReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Cos", "[", "z", "]"}], ")"}], "^", "2"}], " ", "-", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Sin", "[", "z", "]"}], ")"}], "^", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764270202251645*^9, 3.764270222338032*^9}}],

Cell[BoxData[
 RowBox[{"Cos", "[", 
  RowBox[{"2", " ", "z"}], "]"}]], "Output",
 CellChangeTimes->{3.764270222803937*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tan", "[", "x", "]"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"d", "-", "1"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Cos", "[", "x", "]"}], ")"}], "^", "Dpl"}], " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Dpl", " ", "+", " ", "w"}], ")"}], "/", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Dpl", "-", "w"}], ")"}], "/", "2"}], ",", " ", 
         RowBox[{"d", "/", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Sin", "[", "x", "]"}], ")"}], "^", "2"}]}], "]"}]}], 
      ")"}], "^", "2"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"w", ",", "0", ",", 
     RowBox[{"2", "Pi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"0.9", "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", 
     RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764180310750011*^9, 3.7641804365675163`*^9}, {
  3.764180471601898*^9, 3.764180477880101*^9}, {3.764199113948204*^9, 
  3.764199115978136*^9}}],

Cell[BoxData[
 Graphics3DBox[{},
  Axes->True,
  AxesLabel->{None, None, None},
  BoxRatios->{1, 1, 0.4},
  DisplayFunction->Identity,
  FaceGridsStyle->Automatic,
  ImageSize->{294.7035133470214, 279.4183962802844},
  Method->{"DefaultBoundaryStyle" -> Directive[
      GrayLevel[0.3]], "RotationControl" -> "Globe"},
  PlotRange->
   NCache[{{0, 2 Pi}, {1.413716694115407, Rational[1, 2] Pi}, {0., 0.}}, {{
     0, 6.283185307179586}, {1.413716694115407, 1.5707963267948966`}, {0., 
     0.}}],
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02], 
    Scaled[0.02]},
  Ticks->{Automatic, Automatic, Automatic},
  ViewPoint->{0.06249527417229583, -3.3119096949423907`, 0.6909041273958779},
  ViewVertical->{0., 0., 1.}]], "Output",
 CellChangeTimes->{3.7641803682849617`*^9, 3.764180402666333*^9, 
  3.764180437302341*^9, 3.76418048101178*^9, 3.7641991166962137`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{645, 671},
WindowMargins->{{Automatic, 68}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 552, 9, 134, "Section"],
Cell[1135, 33, 190, 3, 28, "Input"],
Cell[1328, 38, 1094, 23, 80, "Input"],
Cell[CellGroupData[{
Cell[2447, 65, 115, 2, 28, "Input"],
Cell[2565, 69, 134, 3, 28, "Output"]
}, Open  ]],
Cell[2714, 75, 2589, 66, 114, "Input"],
Cell[CellGroupData[{
Cell[5328, 145, 2442, 67, 148, "Input"],
Cell[7773, 214, 198, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8008, 222, 1458, 43, 114, "Input"],
Cell[9469, 267, 161, 3, 47, "Output"]
}, Open  ]],
Cell[9645, 273, 4828, 131, 267, "Input"],
Cell[14476, 406, 1758, 51, 131, "Input"],
Cell[16237, 459, 14587, 404, 896, "Input"],
Cell[30827, 865, 368, 7, 46, "Input"],
Cell[CellGroupData[{
Cell[31220, 876, 443, 10, 28, "Input"],
Cell[31666, 888, 323, 7, 46, "Output"]
}, Open  ]],
Cell[32004, 898, 1992, 36, 28, "Input"],
Cell[CellGroupData[{
Cell[34021, 938, 579, 15, 46, "Input"],
Cell[34603, 955, 186, 5, 28, "Output"]
}, Open  ]],
Cell[34804, 963, 1778, 35, 80, "Input"],
Cell[CellGroupData[{
Cell[36607, 1002, 795, 19, 28, "Input"],
Cell[37405, 1023, 6457, 132, 556, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43899, 1160, 868, 23, 80, "Input"],
Cell[44770, 1185, 6672, 132, 556, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51479, 1322, 156, 3, 28, "Input"],
Cell[51638, 1327, 110, 1, 28, "Output"]
}, Open  ]],
Cell[51763, 1331, 2547, 68, 165, "Input"],
Cell[54313, 1401, 6258, 174, 250, "Input"],
Cell[60574, 1577, 146, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[60745, 1584, 316, 8, 28, "Input"],
Cell[61064, 1594, 563, 17, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61664, 1616, 336, 10, 28, "Input"],
Cell[62003, 1628, 98, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62138, 1634, 326, 9, 28, "Input"],
Cell[62467, 1645, 122, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62626, 1653, 1262, 38, 80, "Input"],
Cell[63891, 1693, 875, 22, 294, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
